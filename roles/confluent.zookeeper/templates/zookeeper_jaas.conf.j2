{% if sasl_protocol == 'kerberos' %}
// Specifies a unique keytab and principal name for each ZooKeeper node
Server {
    com.sun.security.auth.module.Krb5LoginModule required
    useKeyTab=true
    keyTab="{{kerberos.keytab_dir}}/{{zookeeper_kerberos_keytab_path | basename}}"
    storeKey=true
    useTicketCache=false
    principal="{{zookeeper_kerberos_principal}}";
};
{% endif %}

{% if zookeeper_sasl_digestmd5_enabled %}
QuorumServer {
       org.apache.zookeeper.server.auth.DigestLoginModule required
       user_zookeeper="{{zookeeper_sasl_digestmd5_internode_password}}";
};

QuorumLearner {
       org.apache.zookeeper.server.auth.DigestLoginModule required
       username="zookeeper"
       password="{{zookeeper_sasl_digestmd5_internode_password}}";
};

Server {
    org.apache.zookeeper.server.auth.DigestLoginModule required
    user_{{zookeeper_sasl_digestmd5_superuser_login}}="{{zookeeper_sasl_digestmd5_superuser_password}}";
};

{% endif %}