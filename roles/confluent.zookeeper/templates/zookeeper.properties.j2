# Maintained by Ansible
{% for key, value in zookeeper.properties.items() %}
{{key}}={{value}}
{% endfor %}

{% if zookeeper_sasl_digestmd5_enabled %}
quorum.auth.enableSasl=true
quorum.auth.learnerRequireSasl=true
quorum.auth.serverRequireSasl=true
quorum.auth.learner.loginContext=QuorumLearner
quorum.auth.server.loginContext=QuorumServer
quorum.cnxn.threads.size=20
requireClientAuthScheme=sasl
{% for host in groups['zookeeper'] %}
authProvider.{{ hostvars[host]['zookeeper_id'] | default(groups.zookeeper.index(host) + 1)}}=org.apache.zookeeper.server.auth.SASLAuthenticationProvider
{% endfor %}
{% endif %}

#Usually hostname or fqdn is defined in /etc/hosts as 127.0.1.1, it makes zookeeper listen on it and loosing ability to accept incoming connection
#So make in listen on 0.0.0.0
{% for host in groups['zookeeper'] %}
server.{{ hostvars[host]['zookeeper_id'] | default(groups.zookeeper.index(host) + 1)}}={{ '0.0.0.0' if host == inventory_hostname else hostvars[host]['ansible_fqdn']  }}:{{zookeeper_peer_port}}:{{zookeeper_leader_port}}
{% endfor %}
